<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>23plusone Research | Intro · SWLS-3 · WHO-5</title>
  <link rel="stylesheet" href="styles/tw.build.css">
  <!-- Google Fonts: Poppins to match scan.html -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <script>window.RESEARCH_MODE = true;</script>
  <script src="scripts/viewport.js"></script>
  <style>
    :root { --footer-h: 64px; --btn-active-pink: #c2185b; --box-shrink: 72px; }
    html, body { height: calc(var(--vh, 1vh) * 100); overflow: hidden; }
    body { font-family: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
    .section { height: calc(var(--vh, 1vh) * 100 - var(--footer-h)); display: none; width: 100%; overflow: hidden; padding-top: 8px; padding-bottom: 8px; position: relative; }
    /* When embedding the scan (iframe), footer is hidden → use full viewport height */
    #scanHost.section { height: calc(var(--vh, 1vh) * 100); }
    .active { display: flex; }
    .qcard { width: 100%; max-width: 1100px; margin-left: auto; margin-right: auto; padding-left: 24px; padding-right: 24px; }
    .qgrid { width: 100%; display: grid; row-gap: 24px; column-gap: var(--col-gap, 24px); }
    /* Desktop: keep labels on one line by giving first column more space */
    /* Unified column geometry across SWLS (7) and WHO-5 (6) */
    .likert-7 { grid-template-columns: minmax(460px, 2fr) repeat(7, minmax(64px, 1fr)); }
    .likert-7-only { grid-template-columns: repeat(7, minmax(64px, 1fr)); }
    .likert-6 { grid-template-columns: minmax(460px, 2fr) repeat(6, minmax(64px, 1fr)); }
    .likert-6-only { grid-template-columns: repeat(6, minmax(64px, 1fr)); }
    .cell-h { font-size: 12px; color: #9c8078; text-align: center; line-height: 1.15; }
    .cell-l { font-size: 16px; color: #e91e63; white-space: nowrap; text-align: left; }
    /* SWLS redesigned separators and question styling */
    .swls-sep { border-top: 2px dotted #e91e63; opacity: 0.7; margin: 32px 0 12px; }
    .swls-q { font-size: 16px; color: #e91e63; margin-bottom: 12px; }
    /* WHO-5 center label spans two columns (between middle dots) */
    .who5-mid { grid-column: 3 / span 2; text-align: center; }
    /* WHO-5 vertical spacing to better match mockup */
    #who5 .swls-sep { margin: 28px 0 10px; }
    #who5 .swls-q { margin-bottom: 10px; }
    #who5 .qgrid.likert-6-only.mt-6 { margin-top: 14px !important; }
    /* Remove earlier nudge hack if present */
    #swls .qcard, #who5 .qcard { transform: none; }
    /* Consistent section titles: absolute at a shared top offset */
    .title-wrap { position: absolute; top: var(--title-top, 96px); left: 0; right: 0; }
    .title-inner { width: 100%; max-width: 1100px; margin-left: auto; margin-right: auto; padding-left: 24px; padding-right: 24px; }
    .title-inner h2 { text-align: center; }
    .content-wrap { width: 100%; padding-top: calc(var(--title-top, 96px) + 24px); }
    /* Ensure submit buttons clear the footer and align across sections */
    #who5 #toScan { margin-bottom: 12px; }
    #swls #toWho5 { margin-bottom: 12px; }
    .choice { width: 22px; height: 22px; border-radius: 9999px; border: 2px solid #b98c86; margin-left: auto; margin-right: auto; display: inline-flex; align-items: center; justify-content: center; position: relative; background: #fff; transition: border-color 120ms ease, box-shadow 120ms ease; }
    .choice.active { background-color: #fff; border-color: #e91e63; }
    .choice.active::after { content: ""; position: absolute; inset: 4px; background-color: #e91e63; border-radius: 9999px; }
    .choice:focus-visible { outline: 3px solid rgba(226, 0, 122, 0.35); outline-offset: 3px; }
    /* Compact default spacing for submit buttons */
    #toWho5, #toScan { margin-top: 16px; position: static; bottom: auto; }
    @media (min-width: 768px) { #toWho5, #toScan { margin-top: 36px; } }
    /* Equal-height one-box layout for SWLS and WHO-5 */
    #swls .qcard, #who5 .qcard {
      /* Override flex to use grid rows: title / content / submit */
      display: grid;
      grid-template-rows: auto 1fr auto;
      /* Fill visible section height minus the section's vertical padding (8px top + 8px bottom) */
      height: calc(100% - 16px - var(--box-shrink));
      width: 100%;
    }
    /* Ensure the middle content stretches fully (no scroll) */
    #swls .qcard > div.w-full, #who5 .qcard > div.w-full {
      align-self: stretch;
      overflow: hidden;
    }
    /* Prevent double-tap zoom and make taps feel instant */
    html, body, button, .choice { touch-action: manipulation; }
    /* Keep form area scroll-free but allow inner grids to flow naturally */
    #swlsForm, #who5Form { overflow: visible; }
    /* Center the submit buttons in the grid's last row */
    #swls .qcard > button, #who5 .qcard > button { justify-self: center; }
    /* Primary buttons to match scan.html */
    button { -webkit-tap-highlight-color: transparent; transition: background-color 120ms ease, transform 60ms ease; }
    #toSwlsIntro:active, #toWho5:active, #toScan:active { background-color: var(--btn-active-pink); transform: translateY(1px); }
    /* Slightly reduce shrink on small screens so content remains comfortable */
    @media (max-width: 768px) { :root { --box-shrink: 36px; } }
    @media (max-width: 480px) { :root { --box-shrink: 24px; } }
    /* Short viewport heights: compress layout to keep submit reachable (no scroll) */
    @media (max-height: 820px) {
      :root { --title-top: 72px; --box-shrink: 120px; }
      .qgrid { row-gap: 16px; }
      #who5 .swls-sep { margin: 20px 0 8px; }
      #who5 .swls-q { margin-bottom: 8px; }
      #who5 .qgrid.likert-6-only.mt-6 { margin-top: 8px !important; }
      #toWho5, #toScan { margin-top: 12px; }
    }
    @media (max-height: 700px) {
      :root { --title-top: 56px; --box-shrink: 156px; }
      .qgrid { row-gap: 12px; }
      .cell-l { font-size: 14px; }
      .cell-h { font-size: 11px; line-height: 1.15; }
      .choice { width: 18px; height: 18px; }
      .choice.active::after { inset: 3px; }
      #toWho5, #toScan { margin-top: 10px; }
    }
    @media (max-height: 620px) {
      :root { --title-top: 48px; --box-shrink: 180px; }
      .qgrid { row-gap: 10px; }
      #swls .qgrid.likert-7.mb-4 { margin-bottom: 4px !important; }
      #who5 .qgrid.likert-6-only.mt-6 { margin-top: 6px !important; }
      #toWho5, #toScan { margin-top: 8px; }
    }
    /* Extremely short heights */
    @media (max-height: 560px) {
      :root { --title-top: 40px; --box-shrink: 200px; }
      .cell-l { font-size: 13px; }
      .cell-h { font-size: 10px; line-height: 1.1; }
      .choice { width: 16px; height: 16px; }
      .choice.active::after { inset: 3px; }
    }
    @media (max-height: 500px) {
      :root { --title-top: 32px; --box-shrink: 220px; }
      .qgrid { row-gap: 8px; }
      #who5 .swls-sep, #swls .swls-sep { margin: 10px 0 6px; }
      #toWho5, #toScan { margin-top: 6px; }
    }
    @media (max-height: 460px) {
      :root { --title-top: 28px; --box-shrink: 240px; }
      .cell-l { font-size: 12px; }
      .choice { width: 14px; height: 14px; }
      .choice.active::after { inset: 2.5px; }
    }
    /* Compact layout for small tablets/large phones in landscape (481–660px) */
    @media (min-width: 481px) and (max-width: 660px) {
      .qcard { padding-left: 12px; padding-right: 12px; }
      .qgrid { column-gap: 8px; row-gap: 14px; }
      /* SWLS: seven columns + label */
      .likert-7 { grid-template-columns: minmax(180px, 2fr) repeat(7, minmax(30px, 1fr)); }
      .likert-7-only { grid-template-columns: repeat(7, minmax(30px, 1fr)); }
      /* WHO-5: six columns + label */
      .likert-6 { grid-template-columns: minmax(180px, 2fr) repeat(6, minmax(32px, 1fr)); }
      .likert-6-only { grid-template-columns: repeat(6, minmax(32px, 1fr)); }
      .cell-l { font-size: 14px; }
      .cell-h { font-size: 11px; line-height: 1.15; }
      .choice { width: 18px; height: 18px; }
      .choice.active::after { inset: 3px; }
    }
    /* Medium screens: tighten grid so all columns fit (769px–1100px) */
    @media (min-width: 769px) and (max-width: 1100px) {
      /* Match the comfortable 720px layout up through 1100px */
      .qgrid { column-gap: 12px; row-gap: 18px; }
      .likert-7 { grid-template-columns: minmax(240px, 2.4fr) repeat(7, minmax(42px, 1fr)); }
      .likert-7-only { grid-template-columns: repeat(7, minmax(42px, 1fr)); }
      .likert-6 { grid-template-columns: minmax(220px, 2.4fr) repeat(6, minmax(40px, 1fr)); }
      .likert-6-only { grid-template-columns: repeat(6, minmax(40px, 1fr)); }
      .cell-h { white-space: normal !important; line-height: 1.2; }
    }
    /* On small screens, allow wrapping so layout fits */
    @media (max-width: 768px) {
      .qgrid { column-gap: 10px; row-gap: 13px; }
      /* Give labels more room and ensure each dot column has a min width */
      .likert-7 { grid-template-columns: minmax(240px, 2.4fr) repeat(7, minmax(42px, 1fr)); }
      .likert-7-only { grid-template-columns: repeat(7, minmax(42px, 1fr)); }
      .likert-6 { grid-template-columns: minmax(220px, 2.4fr) repeat(6, minmax(40px, 1fr)); }
      .likert-6-only { grid-template-columns: repeat(6, minmax(40px, 1fr)); }
      .cell-l { white-space: normal; word-break: normal; }
      .cell-h { white-space: normal; line-height: 1.2; }
      /* Reset desktop left offset for first choice column */
      /* Ensure consistent centering for all choice dots on mobile */
      .qgrid .choice { margin-left: auto; margin-right: auto; }
      /* SWLS header: show only anchor labels on mobile (keep column space) */
      #swls .qgrid.likert-7.mb-4 > :nth-child(3),
      #swls .qgrid.likert-7.mb-4 > :nth-child(4),
      #swls .qgrid.likert-7.mb-4 > :nth-child(6),
      #swls .qgrid.likert-7.mb-4 > :nth-child(7) { visibility: hidden; }
      /* WHO-5 header: show At no time, Half the time, All the time (keep column space) */
      #who5 .qgrid.likert-6.mb-4 > :nth-child(3),
      #who5 .qgrid.likert-6.mb-4 > :nth-child(5),
      #who5 .qgrid.likert-6.mb-4 > :nth-child(6) { visibility: hidden; }
      /* Replace middle header text with concise 'Half the time' */
      #who5 .qgrid.likert-6.mb-4 > :nth-child(4) { position: relative; color: transparent; }
      #who5 .qgrid.likert-6.mb-4 > :nth-child(4)::after { content: "Half the\A time"; white-space: pre; color: #6b7280; position: absolute; inset: 0; display: block; text-align: center; }
      /* Tighten submit spacing on mobile */
      #toWho5, #toScan { margin-top: 16px; }
    }
    /* On desktop, keep header labels at two lines max (breaks only at <br>) */
    @media (min-width: 900px) {
      .cell-h { white-space: nowrap; }
    }
    @media (max-width: 480px) {
      :root { --footer-h: 48px; }
      .qcard { max-width: 560px; padding-left: 12px; padding-right: 12px; gap: 10px !important; }
      .title-inner { max-width: 560px; padding-left: 12px; padding-right: 12px; }
      /* Tighten headings and copy for readability and to fit one screen */
      .qcard h2, .title-inner h2 { font-size: 1.02rem; line-height: 1.2; }
      .qcard p { font-size: 0.82rem; line-height: 1.2; }
      .qgrid { column-gap: 6px; row-gap: 9px; }
      /* Ensure all six dots fit on very small screens */
      .likert-6 { grid-template-columns: minmax(112px, 2fr) repeat(6, minmax(24px, 1fr)); }
      .likert-6-only { grid-template-columns: repeat(6, minmax(24px, 1fr)); }
      /* Ensure all seven dots fit for SWLS */
      .likert-7 { grid-template-columns: minmax(112px, 2fr) repeat(7, minmax(24px, 1fr)); }
      .likert-7-only { grid-template-columns: repeat(7, minmax(24px, 1fr)); }
      .cell-l { font-size: 12px; line-height: 1.2; }
      .cell-h { font-size: 10px; line-height: 1.05; }
      .choice { width: 14px; height: 14px; }
      .choice.active::after { inset: 2.5px; }
      /* Reduce internal margins that were set inline in markup */
      .qcard .w-full.text-left { margin-top: 8px !important; }
      .qgrid.mb-4 { margin-bottom: 6px !important; }
      /* Compress WHO‑5 row spacing further so 5 questions fit without scroll */
      #who5 .swls-sep { margin: 12px 0 8px; }
      #who5 .swls-q { margin-bottom: 8px; }
      #who5 .qgrid.likert-6-only.mt-6 { margin-top: 10px !important; }
    }
  </style>
</head>
<body class="bg-white text-[#2c1f1c]">
  <main class="min-h-screen flex flex-col items-center" style="padding-bottom: var(--footer-h);">
    <!-- Intro -->
    <section id="intro" class="section active items-center justify-center">
      <div class="qcard flex flex-col items-center gap-8 text-left">
        <div class="max-w-[760px] self-center">
          <h2 class="text-2xl md:text-3xl font-semibold">This research is about<br> happiness. Please help us out!</h2>
          <p class="text-base opacity-80" style="margin-top:160px;">This test is anonymous and consists of three parts:</p>
          <div class="text-base" style="margin-top:30px;">
            <div class="font-semibold text-pink-600">1. Satisfaction</div>
            <div class="font-semibold text-pink-600">2. Well‑being</div>
            <div class="font-semibold text-pink-600">3. Human drives</div>
          </div>
        </div>
        <button id="toSwlsIntro" class="bg-pink-600 rounded-md text-white text-sm font-semibold shadow-sm mt-16 self-center" style="margin-top:160px; width:131px; height:41px;">Continue</button>
      </div>
    </section>

    <!-- SWLS (now after scan) -->
    <section id="swls" class="section items-center justify-center">
      <div class="qcard flex flex-col items-center gap-6 text-left">
        <h2 class="text-2xl font-semibold text-center">1. Tick the box that best matches how much you agree.</h2>
        <div class="w-full self-center text-left" style="max-width:600px; margin-left:auto; margin-right:auto;">
          <div id="swlsForm" class="w-full flex flex-col"></div>
          <div class="qgrid likert-7-only mt-6">
            <div class="cell-h text-left">Strongly<br>disagree</div>
            <div></div>
            <div></div>
            <div class="cell-h">Neutral</div>
            <div></div>
            <div></div>
            <div class="cell-h text-right">Strongly<br>agree</div>
          </div>
        </div>
        <button id="toWho5" class="bg-pink-600 rounded-md text-white text-sm font-semibold shadow-sm" style="width:131px; height:41px;">Submit</button>
      </div>
    </section>

    <!-- WHO-5 -->
    <section id="who5" class="section items-center justify-center">
      <div class="qcard flex flex-col items-center gap-6 text-left">
        <h2 class="text-2xl font-semibold text-center">2. Tick the box that matches to how you felt in the last two weeks.</h2>
        <div class="w-full self-center text-left" style="max-width:600px; margin-left:auto; margin-right:auto;">
          <div id="who5Form" class="w-full flex flex-col"></div>
          <div class="qgrid likert-6-only mt-6">
            <div class="cell-h text-left">At no<br>time</div>
            <div></div>
            <div class="cell-h who5-mid">Half the<br>time</div>
            <div></div>
            <div class="cell-h text-right">All the<br>time</div>
          </div>
        </div>
        <button id="toScan" class="bg-pink-600 rounded-md text-white text-sm font-semibold shadow-sm" style="width:131px; height:41px;">Submit</button>
      </div>
    </section>

    <!-- Reuse existing scan via iframe to avoid code duplication -->
    <section id="scanHost" class="section items-center justify-center">
      <iframe id="scanFrame" src="scan.html?mode=research" title="Happiness Scan" style="width:100%; height:100%; border:0;"></iframe>
    </section>

    <!-- Thanks screen -->
    <section id="thanks" class="section items-center justify-center">
      <div class="qcard flex flex-col items-center gap-6 text-left">
        <h2 class="text-2xl font-semibold text-center">Thank you for participating!</h2>
        <p class="text-base opacity-80 text-center" style="max-width:640px;">Your responses have been recorded. You can close this window.</p>
      </div>
    </section>
  </main>

  <footer id="globalFooter" class="fixed bottom-0 left-0 right-0 bg-white border-t border-neutral-200">
    <div class="w-full grid items-center text-yellow-950 text-xs px-6 md:px-16" style="height: 100%; grid-template-columns: 1fr auto 1fr;">
      <div class="opacity-80 flex items-center h-full" style="justify-self: start;"><img src="Br-ndLogo.webp" alt="BR-ND People logo" class="w-auto" style="height: auto; width: auto; max-height: calc(var(--footer-h) - 12px);"></div>
      <div class="opacity-80" style="justify-self: center;">© 2006-2025 Cramer & Koene</div>
      <div class="opacity-80 flex items-center h-full" style="justify-self: end;"><img src="23plusone.png" alt="23plusone logo" class="w-auto" style="height: auto; width: auto; max-height: calc((var(--footer-h) - 12px) * 0.55);"></div>
    </div>
  </footer>

  <!-- Templates for dynamic rendering -->
  <template id="swlsRow">
    <div class="w-full">
      <hr class="swls-sep">
      <div class="swls-q"></div>
      <div class="qgrid likert-7-only items-center">
        <button type="button" class="choice" data-val="1" aria-label="1"></button>
        <button type="button" class="choice" data-val="2" aria-label="2"></button>
        <button type="button" class="choice" data-val="3" aria-label="3"></button>
        <button type="button" class="choice" data-val="4" aria-label="4"></button>
        <button type="button" class="choice" data-val="5" aria-label="5"></button>
        <button type="button" class="choice" data-val="6" aria-label="6"></button>
        <button type="button" class="choice" data-val="7" aria-label="7"></button>
      </div>
    </div>
  </template>

  <template id="who5Row">
    <div class="w-full">
      <hr class="swls-sep">
      <div class="swls-q"></div>
      <div class="qgrid likert-6-only items-center">
        <button type="button" class="choice" data-val="0" aria-label="At no time"></button>
        <button type="button" class="choice" data-val="1" aria-label=""></button>
        <button type="button" class="choice" data-val="2" aria-label=""></button>
        <button type="button" class="choice" data-val="3" aria-label="Half the time"></button>
        <button type="button" class="choice" data-val="4" aria-label=""></button>
        <button type="button" class="choice" data-val="5" aria-label="All the time"></button>
      </div>
    </div>
  </template>

  <script src="scripts/research.js" defer></script>
</body>
</html>


