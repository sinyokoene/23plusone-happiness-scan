<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>Research Results</title>
  <link rel="stylesheet" href="styles/tw.build.css">
  <style>
    html, body { height: 100%; }
    body { font-family: Poppins, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
    .container { max-width: 1200px; margin: 0 auto; padding: 24px; }
    .card { background: #fff; border: 1px solid #e5e7eb; border-radius: 10px; padding: 16px; }
    .grid { display: grid; grid-template-columns: repeat(12, 1fr); gap: 16px; }
    .col-6 { grid-column: span 6; }
    .col-12 { grid-column: span 12; }
    canvas { width: 100%; height: 320px; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border-bottom: 1px solid #eee; padding: 8px; text-align: left; font-size: 12px; }
  </style>
  <script>window.RESEARCH_RESULTS = true;</script>
</head>
<body class="bg-white text-[#2c1f1c]">
  <main class="container">
    <div class="flex items-center justify-between mb-4">
      <img src="Br-ndLogo.webp" alt="BR-ND People" style="height:48px; width:auto;" />
      <h1 class="text-2xl font-semibold">Research Results</h1>
      <img src="23plusone.png" alt="23plusone" style="height:22px; width:auto;" />
    </div>
    <div class="card mb-4">
      <div class="flex items-center gap-3 mb-2 text-sm">
        <label>Device
          <select id="filterDevice" class="border rounded px-2 py-1">
            <option value="">All</option>
            <option value="mobile">Mobile</option>
            <option value="desktop">Desktop</option>
          </select>
        </label>
        <div class="flex items-center gap-2">
          <span>Input:</span>
          <label class="inline-flex items-center gap-1">
            <input id="modClick" type="checkbox" class="align-middle"> <span>Click</span>
          </label>
          <label class="inline-flex items-center gap-1">
            <input id="modSwipe" type="checkbox" class="align-middle"> <span>Swipe</span>
          </label>
          <label class="inline-flex items-center gap-1">
            <input id="modArrow" type="checkbox" class="align-middle"> <span>Arrow</span>
          </label>
        </div>
        <label class="inline-flex items-center gap-2">
          <input id="filterExclusive" type="checkbox" class="align-middle"> <span>Exclusive only</span>
        </label>
        <label class="inline-flex items-center gap-2">
          <input id="filterNoTimeouts" type="checkbox" class="align-middle"> <span>No timeouts</span>
        </label>
        <label class="inline-flex items-center gap-1">
          <span>Threshold ≥</span>
          <input id="filterThreshold" type="number" min="0" max="100" step="5" placeholder="50" class="border rounded px-2 py-1 w-16">
          <span>%</span>
        </label>
        <button id="applyFilters" class="bg-pink-600 text-white text-xs font-semibold rounded px-3 py-1">Apply</button>
      </div>
      <p class="text-sm opacity-80">
        The bar charts show the <strong>distribution</strong> of responses: how many people scored within each range.
        The scatter charts compare questionnaire totals against the scan’s <strong>IHS</strong> score (Intrinsic Happiness Score).
        In the scatter plots, the <strong>X‑axis</strong> is the questionnaire total (WHO‑5% or SWLS 5–35) and the <strong>Y‑axis</strong> is IHS (0–100).
        The thin line is a simple trend line (ordinary least squares); the caption shows correlation <em>r</em>, p‑value, and slope.
      </p>
    </div>
    <div class="grid">
      <div class="col-12">
        <div class="card"><h2 class="text-xl font-semibold">Distributions</h2></div>
      </div>
      <div class="col-6">
        <div class="card">
          <h2 class="text-lg font-semibold mb-2">WHO‑5 Distribution</h2>
          <canvas id="who5Chart"></canvas>
        </div>
      </div>
      <div class="col-6">
        <div class="card">
          <h2 class="text-lg font-semibold mb-2">SWLS Distribution</h2>
          <canvas id="swlsChart"></canvas>
        </div>
      </div>
      <div class="col-6">
        <div class="card">
          <h2 class="text-lg font-semibold mb-2">IHS Distribution</h2>
          <canvas id="ihsChart"></canvas>
        </div>
      </div>
      <div class="col-6">
        <div class="card">
          <h2 class="text-lg font-semibold mb-2">Cantril Distribution</h2>
          <canvas id="cantrilChart"></canvas>
        </div>
      </div>
      <div class="col-12">
        <div class="card">
          <div class="flex items-center justify-between mb-2">
            <h2 class="text-lg font-semibold">Response Time by Card</h2>
            <label class="text-sm opacity-80">Card
              <select id="cardTimeSelector" class="border rounded px-2 py-1 text-sm" style="min-width:220px"></select>
            </label>
          </div>
          <p class="text-xs opacity-80 mb-2">Histogram of response times for the selected card (0–4000 ms). Timeouts are excluded.</p>
          <canvas id="cardTimeChart"></canvas>
        </div>
      </div>
      <div class="col-12">
        <div class="card">
          <h2 class="text-xl font-semibold">Vs IHS</h2>
          <p class="text-xs opacity-80 mt-1">Correlation (<em>r</em>) shows whether two things move together: near +1 = higher X with higher Y; near 0 = no clear link; near −1 = higher X with lower Y. Correlation is not causation.</p>
        </div>
      </div>
      <div class="col-6">
        <div class="card">
          <h2 class="text-lg font-semibold mb-2">WHO‑5 vs IHS (scatter)</h2>
          <canvas id="who5VsIhs"></canvas>
        </div>
      </div>
      <div class="col-6">
        <div class="card">
          <h2 class="text-lg font-semibold mb-2">SWLS vs IHS (scatter)</h2>
          <canvas id="swlsVsIhs"></canvas>
        </div>
      </div>
      <div class="col-6">
        <div class="card">
          <h2 class="text-lg font-semibold mb-2">Cantril vs IHS (scatter)</h2>
          <canvas id="cantrilVsIhs"></canvas>
        </div>
      </div>
      <div class="col-6">
        <div class="card">
          <div class="flex items-center justify-between">
          <h2 class="text-lg font-semibold mb-2">N1/N2/N3 vs <span id="n123MetricLabel">WHO‑5</span> (scatter)</h2>
            <label class="text-xs opacity-80">Metric
              <select id="n123Metric" class="border rounded px-2 py-1 text-xs">
                <option value="who5" selected>WHO‑5</option>
                <option value="swls">SWLS</option>
                <option value="cantril">Cantril</option>
              </select>
            </label>
          </div>
          <div class="text-xs opacity-80 mb-2">
            <div><strong>N1</strong>: how many “Yes” responses and how quickly (time‑weighted affirmations).</div>
            <div><strong>N2</strong>: coverage — how many different domains you affirmed.</div>
            <div><strong>N3</strong>: balance — how evenly those “Yes” answers are spread across domains.</div>
            <div class="mt-1">Each dot is a person. X = selected questionnaire (scaled), Y = N1/N2/N3. A rising line and positive r means that component tends to be higher for people with higher scores.</div>
          </div>
          <canvas id="n123VsWho5"></canvas>
        </div>
      </div>
      <div class="col-12">
        <div class="card">
          <h2 class="text-lg font-semibold mb-2">Overall correlations vs IHS</h2>
          <div style="overflow:auto;">
            <table id="overallCorrTable">
              <thead>
                <tr>
                  <th>Measure</th>
                  <th>n</th>
                  <th>r</th>
                  <th>p</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <p class="text-[11px] opacity-80 mt-2">p: the p‑value for the correlation’s significance. Smaller means less likely by chance.</p>
        </div>
      </div>
      <div class="col-12">
        <div class="card">
          <div class="text-[11px] opacity-90">
            <div class="font-medium mb-1">Correlation color guide (Pearson’s r)</div>
            <div class="grid" style="grid-template-columns: repeat(6, auto); gap: 10px; align-items: center;">
              <div><span style="display:inline-block;width:12px;height:12px;border-radius:4px;background:#e5e7eb;vertical-align:middle;"></span> 0.00–0.10 trivial</div>
              <div><span style="display:inline-block;width:12px;height:12px;border-radius:4px;background:rgba(250,204,21,.20);vertical-align:middle;"></span> 0.10–0.30 small</div>
              <div><span style="display:inline-block;width:12px;height:12px;border-radius:4px;background:rgba(59,130,246,.18);vertical-align:middle;"></span> 0.30–0.50 moderate</div>
              <div><span style="display:inline-block;width:12px;height:12px;border-radius:4px;background:rgba(16,185,129,.18);vertical-align:middle;"></span> 0.50–0.70 strong</div>
              <div><span style="display:inline-block;width:12px;height:12px;border-radius:4px;background:rgba(168,85,247,.20);vertical-align:middle;"></span> 0.70–0.90 very strong</div>
              <div><span style="display:inline-block;width:12px;height:12px;border-radius:4px;background:rgba(236,72,153,.20);vertical-align:middle;"></span> 0.90–1.00 nearly perfect</div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-12">
        <div class="card">
          <h2 class="text-lg font-semibold mb-2">Domain Correlations (WHO‑5/SWLS/Cantril)</h2>
          <p class="text-xs opacity-80 mb-2">
            <strong>r(affirm, WHO‑5/SWLS/Cantril)</strong>: time‑weighted “Yes” strength in a domain. Higher r = stronger alignment with well‑being. 
            <strong>r(yes‑rate, WHO‑5/SWLS/Cantril)</strong>: percent “Yes” per domain (no timing); similar meaning, simpler measure.
          </p>
          <div style="overflow:auto;">
            <table id="domainCorrTable">
              <thead>
                <tr>
                  <th>Domain</th>
                  <th>r(affirm, WHO‑5)</th>
                  <th>r(affirm, SWLS)</th>
                  <th>r(affirm, Cantril)</th>
                  <th>r(yes‑rate, WHO‑5)</th>
                  <th>r(yes‑rate, SWLS)</th>
                  <th>r(yes‑rate, Cantril)</th>
                  <th>n</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
      <div class="col-12">
        <div class="card">
          <div class="flex items-center justify-between mb-2">
            <h2 class="text-lg font-semibold">Top/Bottom Cards by Correlation</h2>
            <label class="text-xs opacity-80">Metric
              <select id="cardCorrMetric" class="border rounded px-2 py-1 text-xs">
                <option value="yes" selected>Yes rate</option>
                <option value="affirm">Affirmation (time‑weighted)</option>
              </select>
            </label>
          </div>
          <p class="text-xs opacity-80 mb-2">Cards ranked by how their answers align with WHO‑5/SWLS/Cantril. Choose Yes rate or time‑weighted Affirmation. <span class="opacity-70">n = number of participants with a valid response for that card and a matching questionnaire entry; it can be lower when a response timed out or data is missing.</span></p>
          <div class="grid">
            <div class="col-6">
              <h3 class="font-medium mb-1">Top 12</h3>
              <table id="cardTopWho"><thead><tr><th>Card</th><th id="cardRCol1">r yes (WHO‑5)</th><th id="cardRCol2">r yes (SWLS)</th><th id="cardRCol3">r yes (Cantril)</th><th>n</th></tr></thead><tbody></tbody></table>
            </div>
            <div class="col-6">
              <h3 class="font-medium mb-1">Bottom 12</h3>
              <table id="cardBottomWho"><thead><tr><th>Card</th><th id="cardRCol1b">r yes (WHO‑5)</th><th id="cardRCol2b">r yes (SWLS)</th><th id="cardRCol3b">r yes (Cantril)</th><th>n</th></tr></thead><tbody></tbody></table>
            </div>
          </div>
        </div>
      </div>
      <div class="col-12">
        <div class="card">
          <h2 class="text-lg font-semibold mb-2">Card Selection Ranking (Yes counts)</h2>
          <p class="text-xs opacity-80 mb-2">Ranked by how many times each card was selected “Yes” across the filtered dataset.</p>
          <div style="overflow:auto;">
            <table id="cardYesRankingTable">
              <thead><tr><th>Rank</th><th>Card</th><th>Yes count</th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
      <div class="col-12">
        <div class="card">
          <div class="flex items-center justify-between mb-2">
            <h2 class="text-lg font-semibold">Latest Entries</h2>
            <label class="text-sm opacity-80">Limit <input id="limitInput" type="number" value="1500" class="border rounded px-2 py-1 w-20"></label>
          </div>
          <div style="overflow:auto; max-height: 420px;">
            <table id="resultsTable">
              <thead><tr><th>ID</th><th>Created</th><th>Session</th><th>PROLIFIC_PID</th><th>STUDY_ID</th><th>SESSION_ID</th><th>Device</th><th>Time (s)</th><th>Selected</th><th>Rejected</th><th>Timeouts</th><th>WHO‑5</th><th>SWLS</th><th>Cantril</th><th>IHS</th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </main>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jstat@1.9.6/dist/jstat.min.js"></script>
  <script src="scripts/research-results.js" defer></script>
  </body>
  </html>


